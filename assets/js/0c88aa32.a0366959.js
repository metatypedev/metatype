(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[1201],{25788:(e,n,t)=>{"use strict";t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>a,default:()=>u,frontMatter:()=>r,metadata:()=>c,toc:()=>h});var i=t(86070),o=t(25710),s=t(65671);const r={},a="Authentication",c={id:"reference/typegate/authentication/index",title:"Authentication",description:'Authentication enable the typegate to identify the user making the request and share some contextual data (called later "context" or "claims"). This data can then be used by policies or injected into various fields. Authenticated requests must use the Authorization header to provide a token in one of the following format.',source:"@site/docs/reference/typegate/authentication/index.mdx",sourceDirName:"reference/typegate/authentication",slug:"/reference/typegate/authentication/",permalink:"/docs/reference/typegate/authentication/",draft:!1,unlisted:!1,editUrl:"https://github.com/metatypedev/metatype/tree/main/docs/metatype.dev/docs/reference/typegate/authentication/index.mdx",tags:[],version:"current",frontMatter:{},sidebar:"docs",previous:{title:"Typegate",permalink:"/docs/reference/typegate/"},next:{title:"CORS",permalink:"/docs/reference/typegate/cors/"}},d={},h=[{value:"Basic authentication",id:"basic-authentication",level:2},{value:"JWT authentication",id:"jwt-authentication",level:2},{value:"OAuth2 authorization",id:"oauth2-authorization",level:2},{value:"Token flow",id:"token-flow",level:3},{value:"OpenID Connect",id:"openid-connect",level:3},{value:"Embedded providers",id:"embedded-providers",level:3}];function l(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h1,{id:"authentication",children:"Authentication"}),"\n",(0,i.jsxs)(n.p,{children:['Authentication enable the typegate to identify the user making the request and share some contextual data (called later "context" or "claims"). This data can then be used by policies or injected into various fields. Authenticated requests must use the ',(0,i.jsx)(n.code,{children:"Authorization"})," header to provide a token in one of the following format."]}),"\n",(0,i.jsx)(n.h2,{id:"basic-authentication",children:"Basic authentication"}),"\n",(0,i.jsxs)(n.p,{children:["Basic authentication is the simplest way to authenticate requests. It is done by sending a base64 encoded string of your username and password in the authorization header. Recall that base64 encoding is not encryption and can be easily reversed, thus ",(0,i.jsx)(n.strong,{children:"the traffic must be encrypted with SSL/TLS"})," when using basic authentication as your password will otherwise be visible."]}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Components"}),(0,i.jsx)(n.th,{children:"Values"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Secrets"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"BASIC_[username]=password"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Header"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"Authorization: Basic base64(username:password)"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Context"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"{ username }"})})]})]})]}),"\n",(0,i.jsx)(s.A,{typegraph:"basic-authentication",python:t(33175),typescript:t(26217),query:t(3987),headers:{Authorization:"Basic YWRtaW46cGFzc3dvcmQ="},tab:"headers"}),"\n",(0,i.jsx)(n.h2,{id:"jwt-authentication",children:"JWT authentication"}),"\n",(0,i.jsx)(n.p,{children:"A more secure way to authenticate requests is to use JSON Web Tokens. The context of a user is signed with a secret key and the typegate will verify the signature to ensure the context has not been tampered with. The JWT is then sent in the authorization header."}),"\n",(0,i.jsxs)(n.p,{children:["The JWT is usually generated by an external identity provider (IdP) such as Keycloak or Auth0 and limited in time. The typegate will check that the ",(0,i.jsx)(n.code,{children:"exp"})," (expiration time) and ",(0,i.jsx)(n.code,{children:"nbf"})," (not before) are valid if they exist in the context. The logic of refreshing expired tokens is left to the user or the IdP client library being used."]}),"\n",(0,i.jsxs)(n.p,{children:['The typegate supports the most frequently used algorithms for signing the JWT and can be imported as using "jwk", "raw", "pkcs8" or "spki" formats (see SubtleCrypto ',(0,i.jsx)(n.a,{href:"https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/importKey",children:"documentation"}),"). For instance, an asymmetric key pair can be generated with the following command:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'const keys = await crypto.subtle.generateKey(\n  { name: "ECDSA", namedCurve: "P-384" },\n  true,\n  ["sign", "verify"],\n);\nconst publicKey = await crypto.subtle.exportKey("jwk", keys.publicKey);\n// save keys.privateKey for later use\nconsole.log(JSON.stringify(publicKey));\n// in typegraph: Auth.jwt("keycloak", "jwk", {"name": "ECDSA", "namedCurve": "P-384"})\n'})}),"\n",(0,i.jsx)(n.p,{children:"Even though, asymmetric encryption is recommended, HMAC-SHA256 is so commonly used that an alias is provided for it."}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Components"}),(0,i.jsx)(n.th,{children:"Values"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Secrets"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"[authentication]_JWT=secret"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Header"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"Authorization: Bearer token"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Context"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"{ your_own_content }"})})]})]})]}),"\n",(0,i.jsx)(s.A,{typegraph:"jwt-authentification",python:t(8980),typescript:t(37538),query:t(36722),headers:{Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ5b3VyX293bl9jb250ZW50IjoiY3VzdG9tLXJvbGUifQ.r7sR34FQSJbZTz8PNHbnQBXaRlK9Mo3BM5Rd9R8XuNQ"},tab:"headers"}),"\n",(0,i.jsx)(n.p,{children:"Note that for the sake of the demo, the token has no expiration time. Tokens should always be shorted lived and refreshed frequently to reduce the risk of unexpected access."}),"\n",(0,i.jsx)(n.h2,{id:"oauth2-authorization",children:"OAuth2 authorization"}),"\n",(0,i.jsx)(n.p,{children:"OAuth2 allows a user to grant limited access to their resources on one site, to another site, without having to expose their credentials. It is commonly used when the typegate needed to access restricted information in third-parties such as Google or GitHub."}),"\n",(0,i.jsx)(n.p,{children:"Most of the time, the OAuth2 is managed by your identity provider and relies on the JWT authentication as explained above. However the typegate provides a simple way to handle the OAuth2 flow without IdP or when the system should be lightweight."}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Components"}),(0,i.jsx)(n.th,{children:"Values"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Secrets"}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"[authentication]_CLIENT_ID=client_id"}),", ",(0,i.jsx)(n.code,{children:"[authentication]_CLIENT_SECRET=client_secret"})]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Header"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"Authorization: Bearer token"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Context"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"{ content_from_your_idp }"})})]})]})]}),"\n",(0,i.jsxs)(n.p,{children:["The OAuth2 authorization system requires you to have a redis instance configured for the typegate to store states. See ",(0,i.jsx)(n.a,{href:"#typegate-configuration",children:"configuration"})," for more details."]}),"\n",(0,i.jsx)(n.h3,{id:"token-flow",children:"Token flow"}),"\n",(0,i.jsxs)(n.p,{children:["The typegate uses ",(0,i.jsx)(n.a,{href:"https://www.oauth.com/oauth2-servers/pkce/authorization-request/",children:"PKCE"})," based authorization. The steps are the following:"]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Redirect the user to `https://[typegate].metatype.cloud/[typegraph]/auth/[authentication] with the following search parameters:"}),"\n"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"client_id"}),": The client id of your application defined in the typegraph"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"redirect_uri"}),": The redirect URI of your application defined in the typegraph"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"state"}),": A random string used to prevent CSRF"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"code_challenge"}),": A hashed of the string used as a code verifier"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"code_challenge_method"}),": Set to S256"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"scope"}),": The scope of the token (optional)"]}),"\n"]}),"\n",(0,i.jsxs)(n.ol,{start:"2",children:["\n",(0,i.jsxs)(n.li,{children:["When the user has completed the flow, the typegate will redirect the user to ",(0,i.jsx)(n.code,{children:"https://your-website.com/login"})," with an authorization ",(0,i.jsx)(n.code,{children:"code"})," that you can exchange for a token from the typegate as follows. It is done by making a ",(0,i.jsx)(n.code,{children:"POST"})," request to ",(0,i.jsx)(n.code,{children:"https://[typegate].metatype.cloud/[typegraph]/auth/token"})," with the following body:"]}),"\n"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"code"}),": The authorization code from the typegate"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"code_verifier"}),": The inital code verifier"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"grant_type"}),": Set to ",(0,i.jsx)(n.code,{children:"authorization_code"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"client_id"}),": The set client id"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"redirect_uri"}),": The previous redirect URI"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'const claims = await fetch(\n  "https://[typegate].metatype.cloud/[typegraph]/auth/token",\n  {\n    method: "POST",\n    headers: { "Content-Type": "application/json" },\n    body: JSON.stringify({\n      code: "code",\n      code_verifier: "code_verifier",\n      grant_type: "authorization_code",\n      client_id: "client_id",\n      redirect_uri: "redirect_uri",\n    }),\n  },\n);\nconst { token } = await claims.json();\n'})}),"\n",(0,i.jsx)(n.p,{children:"The returned token will have the following fields:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"access_token"}),": Used to make authentified requests"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"refresh_token"}),": Used to get another token"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"token_type"}),": Set to Bearer"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"expires_in"}),": Expiration time"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"scope"}),": The scope of the token"]}),"\n"]}),"\n",(0,i.jsxs)(n.ol,{start:"3",children:["\n",(0,i.jsxs)(n.li,{children:["The ",(0,i.jsx)(n.code,{children:"access_token"})," can then be used as JWT in the ",(0,i.jsx)(n.code,{children:"Authorization"})," header of your requests to make authentified calls."]}),"\n"]}),"\n",(0,i.jsx)(s.A,{typegraph:"oauth2_authentication",python:t(42422),typescript:t(23680),query:t(64572),headers:{Authorization:"Bearer your-token"},tab:"headers"}),"\n",(0,i.jsxs)(n.ol,{start:"4",children:["\n",(0,i.jsxs)(n.li,{children:["When the token is expired, you can claim another token by using your ",(0,i.jsx)(n.code,{children:"refresh_token"})," by making a ",(0,i.jsx)(n.code,{children:"POST"})," request to the token endpoint [https://[typegate].metatype.cloud/[typegraph]/auth/token] with the following body:"]}),"\n"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"grant_type"}),": Set to ",(0,i.jsx)(n.code,{children:"refresh_token"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"refresh_token"}),": The previously received refresh token"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"client_id"}),": The set client id"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"scope"}),": The new token scope (optional)"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'const claims = await fetch(\n  "https://[typegate].metatype.cloud/[typegraph]/auth/token",\n  {\n    method: "POST",\n    headers: { "Content-Type": "application/json" },\n    body: JSON.stringify({\n      grant_type: "refresh_token",\n      refresh_token: "refresh_token",\n      client_id: "client_id",\n    }),\n  },\n);\nconst { token } = await claims.json();\n'})}),"\n",(0,i.jsx)(n.h3,{id:"openid-connect",children:"OpenID Connect"}),"\n",(0,i.jsxs)(n.p,{children:["OpenID Connect is an authentication layer on top of OAuth2. It is used to verify the identity of the user and retrieve basic information about them. You can add ",(0,i.jsx)(n.code,{children:"openid"})," to the OAuth2 scope and you will receive an ",(0,i.jsx)(n.code,{children:"id_token"})," in the response. The ",(0,i.jsx)(n.code,{children:"id_token"})," is a JWT that contains the user's information and is signed by the IdP."]}),"\n",(0,i.jsx)(n.h3,{id:"embedded-providers",children:"Embedded providers"}),"\n",(0,i.jsx)(n.p,{children:"Frequent OAuth2 providers are embedded and can be directly used in the typegraph."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'from typegraph.graph.params import Auth\n\nAuth.oauth2(\n    provider="github",\n    scopes=["openid", "profile", "email"],\n    clients=[\n        {\n            "id_secret": "APP_CLIENT_ID",\n            "redirect_uri_secret": "APP_REDIRECT_URI",\n        }\n    ],\n)\n\n'})}),"\n",(0,i.jsx)(n.p,{children:"The available providers are:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"digitalocean"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"discord"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"dropbox"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"facebook"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"github"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"gitlab"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"google"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"instagram"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"linkedin"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"microsoft"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"reddit"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"slack"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"stackexchange"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"twitter"})}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}},3987:e=>{var n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",variableDefinitions:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"get_context"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"username"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:43}};n.loc.source={body:"query {\n  get_context {\n    username\n  }\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};function t(e,n){if("FragmentSpread"===e.kind)n.add(e.name.value);else if("VariableDefinition"===e.kind){var i=e.type;"NamedType"===i.kind&&n.add(i.name.value)}e.selectionSet&&e.selectionSet.selections.forEach((function(e){t(e,n)})),e.variableDefinitions&&e.variableDefinitions.forEach((function(e){t(e,n)})),e.definitions&&e.definitions.forEach((function(e){t(e,n)}))}var i={};n.definitions.forEach((function(e){if(e.name){var n=new Set;t(e,n),i[e.name.value]=n}})),e.exports=n},36722:e=>{var n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",variableDefinitions:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"get_context"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"your_own_content"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:51}};n.loc.source={body:"query {\n  get_context {\n    your_own_content\n  }\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};function t(e,n){if("FragmentSpread"===e.kind)n.add(e.name.value);else if("VariableDefinition"===e.kind){var i=e.type;"NamedType"===i.kind&&n.add(i.name.value)}e.selectionSet&&e.selectionSet.selections.forEach((function(e){t(e,n)})),e.variableDefinitions&&e.variableDefinitions.forEach((function(e){t(e,n)})),e.definitions&&e.definitions.forEach((function(e){t(e,n)}))}var i={};n.definitions.forEach((function(e){if(e.name){var n=new Set;t(e,n),i[e.name.value]=n}})),e.exports=n},64572:e=>{var n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",variableDefinitions:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"get_context"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"exp"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:38}};n.loc.source={body:"query {\n  get_context {\n    exp\n  }\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};function t(e,n){if("FragmentSpread"===e.kind)n.add(e.name.value);else if("VariableDefinition"===e.kind){var i=e.type;"NamedType"===i.kind&&n.add(i.name.value)}e.selectionSet&&e.selectionSet.selections.forEach((function(e){t(e,n)})),e.variableDefinitions&&e.variableDefinitions.forEach((function(e){t(e,n)})),e.definitions&&e.definitions.forEach((function(e){t(e,n)}))}var i={};n.definitions.forEach((function(e){if(e.name){var n=new Set;t(e,n),i[e.name.value]=n}})),e.exports=n},33175:e=>{e.exports={content:'@typegraph(\n)\ndef basic_authentication(g: Graph):\n  deno = DenoRuntime()\n  public = Policy.public()\n\n  ctx = t.struct({"username": t.string().optional()})\n\n  # highlight-next-line\n  g.auth(Auth.basic(["admin"]))\n\n  g.expose(\n    public,\n    get_context=deno.identity(ctx).apply(\n      {\n        "username": g.from_context("username"),\n      }\n    ),\n  )',path:"../examples/typegraphs/basic.py"}},26217:e=>{e.exports={content:'await typegraph(\n  {\n    name: "basic-authentication",\n  },\n  (g) => {\n    const deno = new DenoRuntime();\n    const pub = Policy.public();\n\n    const ctx = t.struct({\n      username: t.string().optional(),\n    });\n\n    // highlight-next-line\n    g.auth(Auth.basic(["admin"]));\n\n    g.expose({\n      get_context: deno\n        .identity(ctx)\n        .apply({\n          username: g.fromContext("username"),\n        })\n        .withPolicy(pub),\n    });\n  },\n);',path:"../examples/typegraphs/basic.ts"}},8980:e=>{e.exports={content:'@typegraph(\n)\ndef jwt_authentication(g: Graph):\n  deno = DenoRuntime()\n  public = Policy.public()\n\n  ctx = t.struct({"your_own_content": t.string().optional()})\n  # highlight-next-line\n  g.auth(Auth.hmac256("custom"))\n\n  g.expose(\n    get_context=deno.identity(ctx).apply(\n      {\n        "your_own_content": g.from_context("your_own_content"),\n      }\n    ),\n    default_policy=[public],\n  )',path:"../examples/typegraphs/jwt.py"}},37538:e=>{e.exports={content:'typegraph(\n  {\n    name: "jwt-authentication",\n  },\n  (g) => {\n    const deno = new DenoRuntime();\n    const pub = Policy.public();\n\n    const ctx = t.struct({\n      your_own_content: t.string().optional(),\n    });\n    // highlight-next-line\n    g.auth(Auth.hmac256("custom"));\n\n    g.expose(\n      {\n        get_context: deno.identity(ctx).apply({\n          your_own_content: g.fromContext("your_own_content"),\n        }),\n      },\n      pub,\n    );\n  },\n);',path:"../examples/typegraphs/jwt.ts"}},42422:e=>{e.exports={content:'@typegraph(\n)\ndef oauth2_authentication(g: Graph):\n  deno = DenoRuntime()\n  public = Policy.public()\n\n  ctx = t.struct({"exp": t.integer().optional()})\n\n  # highlight-start\n  g.auth(\n    Auth.oauth2(\n      provider="github",\n      scopes=["openid", "profile", "email"],\n      clients=[\n        {\n          "id_secret": "APP_CLIENT_ID",\n          "redirect_uri_secret": "APP_REDIRECT_URI",\n        }\n      ],\n    )\n  )\n  # highlight-end\n\n  g.expose(\n    public,\n    get_context=deno.identity(ctx).apply(\n      {\n        "exp": g.from_context("exp"),\n      }\n    ),\n  )',path:"../examples/typegraphs/oauth2.py"}},23680:e=>{e.exports={content:'typegraph(\n  {\n    name: "oauth2-authentication",\n  },\n  (g) => {\n    const deno = new DenoRuntime();\n    const pub = Policy.public();\n\n    const ctx = t.struct({ exp: t.integer().optional() });\n\n    // highlight-start\n    g.auth(\n      Auth.oauth2({\n        provider: "github",\n        scopes: ["openid", "profile", "email"],\n        clients: [\n          { idSecret: "APP_CLIENT_ID", redirectUriSecret: "APP_REDIRECT_URI" },\n        ],\n      }),\n    );\n    // highlight-end\n\n    g.expose(\n      {\n        get_context: deno.identity(ctx).apply({\n          exp: g.fromContext("exp"),\n        }),\n      },\n      pub,\n    );\n  },\n);',path:"../examples/typegraphs/oauth2.ts"}}}]);