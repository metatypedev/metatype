"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[5190],{78294:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>h,contentTitle:()=>l,default:()=>p,frontMatter:()=>c,metadata:()=>o,toc:()=>a});var s=n(86070),r=n(25710),d=n(65480),i=n(27676);const c={},l="Wasm",o={id:"reference/runtimes/wasm/index",title:"Wasm",description:"Wasm runtime",source:"@site/docs/reference/runtimes/wasm/index.mdx",sourceDirName:"reference/runtimes/wasm",slug:"/reference/runtimes/wasm/",permalink:"/docs/reference/runtimes/wasm/",draft:!1,unlisted:!1,editUrl:"https://github.com/metatypedev/metatype/tree/main/website/docs/reference/runtimes/wasm/index.mdx",tags:[],version:"current",frontMatter:{},sidebar:"docs",previous:{title:"Temporal",permalink:"/docs/reference/runtimes/temporal/"},next:{title:"Policies",permalink:"/docs/reference/policies/"}},h={},a=[{value:"Wasm runtime",id:"wasm-runtime",level:2},{value:"Example",id:"example",level:2},{value:"Wit to Typegraph types",id:"wit-to-typegraph-types",level:2}];function x(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.h1,{id:"wasm",children:"Wasm"}),"\n",(0,s.jsx)(t.h2,{id:"wasm-runtime",children:"Wasm runtime"}),"\n",(0,s.jsxs)(t.p,{children:["The Wasm runtime enables the execution of functions authored in any language that can be compiled into WebAssembly and that follows the ",(0,s.jsx)(t.a,{href:"https://component-model.bytecodealliance.org/design/why-component-model.html",children:"component model"}),"."]}),"\n",(0,s.jsx)(t.p,{children:"Common use cases:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"Integrating an existing WebAssembly component"}),"\n",(0,s.jsx)(t.li,{children:"Building language-agnostic services"}),"\n"]}),"\n",(0,s.jsx)(t.h2,{id:"example",children:"Example"}),"\n",(0,s.jsxs)(t.p,{children:["Here is a simple wit component description using ",(0,s.jsx)(t.a,{href:"https://github.com/WebAssembly/component-model/blob/main/design/mvp/WIT.md",children:"wit IDL"})," that exports the ",(0,s.jsx)(t.code,{children:"add"})," function."]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-rust",children:"package example:host;\nworld host {\n  export add: func(a: u32, b: u32) -> u32;\n}\n"})}),"\n",(0,s.jsx)(t.p,{children:"In your typegraph:"}),"\n",(0,s.jsxs)(d.Ay,{children:[(0,s.jsx)(i.A,{value:"python",children:(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-python",children:'from typegraph.runtimes.wasm import WasmRuntime\n\n@typegraph\ndef example(g: Graph):\n    pub = Policy.public()\n    wasm = WasmRuntime.reflected("path/to/your-compiled-component.wasm");\n\n    g.expose(\n        add=wasm.export(\n            t.struct({"a": t.integer(), "b": t.integer()}),\n            t.integer(),\n            name="add",  # exported function\n        )\n    )\n\n'})})}),(0,s.jsx)(i.A,{value:"typescript",children:(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-typescript",children:'import { Policy, t, typegraph } from "@typegraph/sdk";\nimport { WasmRuntime } from "@typegraph/sdk/runtimes/wasm.js";\n\ntypegraph("example", (g) => {\n  const pub = Policy.public();\n  const wasm = WasmRuntime.reflected("path/to/your-compiled-component.wasm");\n\n  g.expose({\n    add: wasm\n      .export(t.struct({ a: t.integer(), b: t.integer() }), t.integer(), {\n        name: "add", // exported function\n      })\n      .withPolicy(pub),\n  });\n});\n'})})})]}),"\n",(0,s.jsx)(t.h2,{id:"wit-to-typegraph-types",children:"Wit to Typegraph types"}),"\n",(0,s.jsx)(t.p,{children:"Wit ensures that you have statically typed values backed directly in your component. You can refer to the correspondence table bellow in how the input/output values are shaped in your typegraph."}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{children:"wit"}),(0,s.jsx)(t.th,{style:{textAlign:"center"},children:"typegraph"}),(0,s.jsx)(t.th,{children:"Example values"})]})}),(0,s.jsxs)(t.tbody,{children:[(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"string"})}),(0,s.jsxs)(t.td,{style:{textAlign:"center"},children:[(0,s.jsx)(t.code,{children:"t.string()"}),", ",(0,s.jsx)(t.code,{children:"t.uuid()"})]}),(0,s.jsx)(t.td,{children:'"Hello world", "H", ..'})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsxs)(t.td,{children:[(0,s.jsx)(t.code,{children:"u8"}),", ",(0,s.jsx)(t.code,{children:"u16"}),", ",(0,s.jsx)(t.code,{children:"u32"}),", ",(0,s.jsx)(t.code,{children:"u64"}),", ",(0,s.jsx)(t.code,{children:"s8"}),", ",(0,s.jsx)(t.code,{children:"s16"}),", ",(0,s.jsx)(t.code,{children:"s32"}),", ",(0,s.jsx)(t.code,{children:"s64"})]}),(0,s.jsxs)(t.td,{style:{textAlign:"center"},children:[(0,s.jsx)(t.code,{children:"t.integer()"}),", ",(0,s.jsx)(t.code,{children:"t.float()"})]}),(0,s.jsx)(t.td,{children:"1, 2, 0, .."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsxs)(t.td,{children:[(0,s.jsx)(t.code,{children:"f32"}),", ",(0,s.jsx)(t.code,{children:"f64"})]}),(0,s.jsx)(t.td,{style:{textAlign:"center"},children:(0,s.jsx)(t.code,{children:"t.float()"})}),(0,s.jsx)(t.td,{children:"3.14, 100, 2, .."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"char"})}),(0,s.jsxs)(t.td,{style:{textAlign:"center"},children:[(0,s.jsx)(t.code,{children:"t.string()"})," (truncated), ",(0,s.jsx)(t.code,{children:"t.integer()"})," (truncated as ",(0,s.jsx)(t.code,{children:"u8"}),"), ",(0,s.jsx)(t.code,{children:"t.float()"})," (truncated as ",(0,s.jsx)(t.code,{children:"u8"}),")"]}),(0,s.jsx)(t.td,{children:'"A", 65, 65.0, ..'})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"option<T>"})}),(0,s.jsx)(t.td,{style:{textAlign:"center"},children:(0,s.jsx)(t.code,{children:"<T>.optional()"})}),(0,s.jsxs)(t.td,{children:[(0,s.jsx)(t.code,{children:"null"}),', "hello world", ..']})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"list<T>"})}),(0,s.jsx)(t.td,{style:{textAlign:"center"},children:(0,s.jsx)(t.code,{children:"t.list(<T>)"})}),(0,s.jsx)(t.td,{children:'["one", "two" ], [1, 2], ..'})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"tuple<T1, T2, ..>"})}),(0,s.jsx)(t.td,{style:{textAlign:"center"},children:(0,s.jsx)(t.code,{children:"t.list(t.enum([t1, t2, ..]))"})}),(0,s.jsx)(t.td,{children:'[1, "one"], [2, "two"], ..'})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"enum example { one, two }"})}),(0,s.jsx)(t.td,{style:{textAlign:"center"},children:(0,s.jsx)(t.code,{children:'t.enum(["one", "two"])'})}),(0,s.jsx)(t.td,{children:'"one", "two"'})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"variant example { one(string), two }"})}),(0,s.jsx)(t.td,{style:{textAlign:"center"},children:(0,s.jsx)(t.code,{children:'t.struct({ "tag": t.enum(["one", "two"]), "value": t.string().optional() )'})}),(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:'{ "tag": "two", "value": null }'})})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"record example { id: string, description: option<string> }"})}),(0,s.jsx)(t.td,{style:{textAlign:"center"},children:(0,s.jsx)(t.code,{children:'t.struct({ "id": t.integer(), "description": t.string().optional() )'})}),(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:'{ "id": 123, "description": "some text"}'})})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"flags example { read, write, delete }"})}),(0,s.jsx)(t.td,{style:{textAlign:"center"},children:(0,s.jsx)(t.code,{children:'t.list(t.enum(["read", "write", "delete"]))'})}),(0,s.jsxs)(t.td,{children:[(0,s.jsx)(t.code,{children:'["read"]'}),", ",(0,s.jsx)(t.code,{children:'["read", "write", "delete"]'}),", .."]})]})]})]})]})}function p(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(x,{...e})}):x(e)}},65480:(e,t,n)=>{n.d(t,{Ay:()=>i,gc:()=>c});n(30758);var s=n(30351),r=n(56315),d=n(86070);function i(e){let{children:t}=e;const[n,i]=(0,s.e)();return(0,d.jsx)(r.mS,{choices:{typescript:"Typescript SDK",python:"Python SDK"},choice:n,onChange:i,children:t})}function c(e){let{children:t}=e;const[n]=(0,s.e)();return(0,d.jsx)(r.q9,{choices:{typescript:"Typescript SDK",python:"Python SDK"},choice:n,children:t})}}}]);