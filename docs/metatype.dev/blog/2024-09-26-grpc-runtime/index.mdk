import BlogIntro from "@site/src/components/BlogIntro";

# Expanding Metatype's Capabilities: Introducing gRPC Runtime

<BlogIntro text="We're excited to announce the new gRPC Runtime feature in Metatype, further enhancing our platform's ability to create versatile and powerful backends through typegraphs." />

## What is Metatype?

Before we dive into the gRPC Runtime, let's recap what Metatype is all about:

Metatype is a revolutionary platform that allows developers to create typegraphs - strongly-typed, composable backend structures. With Metatype, you can:

- Construct solid, type-safe backends
- Leverage multiple runtimes for different services and protocols
- Expose your typegraphs via GraphQL or HTTP endpoints

## Introducing gRPC Runtime

The new gRPC Runtime is the latest addition to Metatype's suite of runtimes, joining existing options like the HTTP runtime. This expansion allows you to incorporate gRPC services into your typegraphs, further enhancing the versatility of your Metatype-powered backends.

## Key Technical Details

### Architecture
The gRPC Runtime integrates seamlessly with Metatype's existing architecture. It acts as a bridge between your typegraph and external gRPC services, allowing you to incorporate gRPC calls alongside other runtime operations in your backend logic.

### Core Components

1. **GrpcRuntime Class**: The main interface for defining gRPC interactions within your typegraph.
2. **proto_file**: Path to the .proto file that defines the gRPC service.
3. **endpoint**: The gRPC server address in the format `tcp://<host>:<port>`.
4. **call method**: Creates a typegraph function for gRPC method calls.

### Implementation

Here's how the gRPC Runtime fits into a Metatype typegraph:

```python
from typegraph import Graph, Policy, typegraph
from typegraph.graph.params import Cors
from typegraph.runtimes.grpc import GrpcRuntime

@typegraph(
    cors=Cors(allow_origin=["https://metatype.dev", "http://localhost:3000"]),
)
def grpc(g: Graph):
    endpoint = "tcp://localhost:4770"
    proto_file = "proto/helloworld.proto"
    grpc_runtime = GrpcRuntime(proto_file, endpoint)
    g.expose(
        Policy.public(),
        greet=grpc_runtime.call("/helloworld.Greeter/SayHello"),
    )
```

### Key Points

1. **Typegraph Integration**: The gRPC Runtime is used within a typegraph, allowing it to be composed with other runtimes and services.
2. **Exposure**: The `g.expose()` method allows you to make the gRPC service accessible via GraphQL or HTTP, depending on how you configure your Metatype backend.
3. **Policy Control**: Metatype's policy system (`Policy.public()` in this example) allows fine-grained access control for your exposed services.

## Benefits for Developers

1. **Unified Backend Structure**: Incorporate gRPC services alongside other protocols and data sources in a single, coherent typegraph.
2. **Type Safety**: Leverage Metatype's strong typing system in conjunction with gRPC's protocol buffers for end-to-end type safety.
3. **Flexible Exposure**: Easily expose your gRPC services via GraphQL or HTTP endpoints, allowing clients to interact with them using their preferred protocol.
4. **Composability**: Combine gRPC calls with other runtime operations, database queries, or business logic within your typegraph.

## Getting Started

To start using the gRPC Runtime in your Metatype project:

1. Ensure you have the latest version of Metatype installed.
2. Prepare your .proto files for the gRPC services you want to integrate.
3. Set up your typegraph as shown in the example above, incorporating the GrpcRuntime.
4. Configure your Metatype backend to expose the typegraph via GraphQL or HTTP as needed.

## Conclusion

The addition of the gRPC Runtime to Metatype further solidifies its position as a comprehensive platform for building robust, type-safe backends. By allowing seamless integration of gRPC services alongside other protocols and data sources, Metatype empowers developers to create versatile and powerful backend systems with ease.

For more detailed documentation, code examples, and best practices, check out our [official Metatype docs](https://metatype.dev/docs)#.
