---
sidebar_position: 2
---

import CodeBlock from "@theme/CodeBlock";
import TGExample from "@site/src/components/TGExample";

# Your first typegraph

The typegraphs - virtual graphs of types - are the secret sauce of the ecosystem. Similar to programming languages type systems, they let the developer describe:

1. _what_ data types exists
2. _how_ these data get transformed
3. _where_ these data and transformations run
4. _who_ can access them

## The type system

There is 4 main categories and no "class" or "primitive" type:

- value types: `t.integer()`, `t.string()`, `t.uuid()`, etc.
- quantifier types: `t.optional(·)`, `t.array(·)`, etc.
- consolidator types: `t.struct(·, ·)`, `t.union(·, ·)`, etc.
- function types: `t.func(· → ·)`, `t.policy(· → ·)`, etc.

This allows to describe almost any data type you may encounter, and typecheck the data flowing through the typegates.

<CodeBlock language="python">{require("./types.py")}</CodeBlock>

## The typegraph package

The typegraph package is a Python package that allows to describe a typegraph. It's a thin wrapper around the type system, and provides a few helpers to make the typegraph definition easier. It builds on the type system to provide some more building blocks:

1. _what_ data types exists → value, quantifier, consolidator **types**
2. _how_ these data get transformed → function types with **materializers** specifying the transformation
3. _where_ these data and transformations run → **runtimes** where materializers operate
4. _who_ can access them → special function types named **policies** that control accesses

This tutorial will cover these abstraction step by step and show how to use them by example.

:::info Code sample are interactive
You can interact with most of the typegraph in the documentation. Some parts might be voluntary hidden and full source can be found on GitHub. Click on "edit this page" to jump there and look into the parent folder.
:::

A simple typegraph looks like this:

<TGExample
  typegraph="first-typegraph"
  python={require("./typegraph.py")}
  query={require("./query.graphql")}
/>

Copy this into a file named `typegraph.py` near your `docker-compose.yml` file.

## The meta CLI

The meta CLI use a config file named `metatype.yml` to give some defaults and avoid typing the same arguments over and over again. It is a simple YAML file that looks like this:

```yaml
typegates:
  dev:
    url: "http://localhost:7890"
    username: admin
    password: password
typegraphs:
  python:
    include: "**/*.py"
```

At this point, you should have everything ready for your first typegraph. Run the following command in your terminal:

```bash
ls -1a
# ./
# ../
# .venv/
# docker-compose.yml
# metatype.yml
# typegraph.py

meta dev
# Loaded 1 typegraph from ./typegraph.py:
#  → Pushing typegraph first-typegraph...
#  ✓ Success!
```

You can now opens [http://localhost:7890/first-typegraph](http://localhost:7890/first-typegraph) in your browser. The CLI will automatically watch for changes in the typegraph and reload the typegraph. You should see a graphql playground and be able to play with your first typegraph, congrats!

<div className="text-center">
  <img
    src={require("./playground.png").default}
    width="600"
    alt="typegate playground"
  />
</div>
